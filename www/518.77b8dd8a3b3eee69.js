"use strict";(self.webpackChunkiot_master_ui=self.webpackChunkiot_master_ui||[]).push([[518],{8989:(M,x,i)=>{i.d(x,{A:()=>C});var n=i(4650);let C=(()=>{var z;class g{}return(z=g).\u0275fac=function(f){return new(f||z)},z.\u0275cmp=n.Xpm({type:z,selectors:[["app-card"]],inputs:{id:"id",name:"name",title:"title",img:"img"},decls:8,vars:5,consts:[[1,"card"],[1,"card-img"],[2,"width","100%","height","100%",3,"src"],[1,"card-inf"],[2,"margin-bottom","5px"]],template:function(f,_){1&f&&(n.TgZ(0,"div",0)(1,"div",1),n._UZ(2,"img",2),n.qZA(),n.TgZ(3,"div",3)(4,"div",4),n._uU(5),n.qZA(),n.TgZ(6,"div"),n._uU(7),n.qZA()()()),2&f&&(n.xp6(2),n.Q6J("src","assets/"+_.img,n.LSH),n.xp6(3),n.AsE("",_.title,"id: ",_.id,""),n.xp6(2),n.AsE("",_.title,"\u540d\u79f0: ",_.name,""))},styles:[".card[_ngcontent-%COMP%]{overflow:hidden;border-radius:5px;box-shadow:0 0 20px #00000080;width:200px;height:264px;background-color:#fff}.card[_ngcontent-%COMP%]   .card-img[_ngcontent-%COMP%]{box-sizing:border-box;padding:10px;border-radius:5px;box-shadow:0 0 20px #00000080}.card[_ngcontent-%COMP%]   .card-inf[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px 10px;color:gray}"]}),g})()},7327:(M,x,i)=>{i.d(x,{J:()=>O});var n=i(4650),C=i(9651),z=i(6895),g=i(6960),t=i(6497),f=i(6616),_=i(7044),A=i(1664),T=i(5545);function F(p,h){if(1&p&&n._uU(0),2&p){const s=n.oxw();n.hij("",s.title,"\u8be6\u60c5")}}function v(p,h){if(1&p&&(n.TgZ(0,"div")(1,"p"),n._uU(2),n.qZA(),n.TgZ(3,"p"),n._uU(4),n.qZA(),n.TgZ(5,"p"),n._uU(6),n.qZA(),n.TgZ(7,"p"),n._uU(8),n.qZA(),n.TgZ(9,"p"),n._uU(10),n.qZA(),n.TgZ(11,"p"),n._uU(12),n.qZA(),n.TgZ(13,"p"),n._uU(14),n.qZA(),n.TgZ(15,"p"),n._uU(16),n.qZA(),n.TgZ(17,"p"),n._uU(18),n.ALo(19,"date"),n.qZA()()),2&p){const s=n.oxw(2);n.xp6(2),n.hij("\u63d2\u4ef6id\uff1a",s.chooseData.id,""),n.xp6(2),n.hij("\u540d\u79f0\uff1a",s.chooseData.name,""),n.xp6(2),n.hij("\u7528\u6237\u540d\uff1a",s.chooseData.username,""),n.xp6(2),n.hij("\u5bc6\u7801\uff1a",s.chooseData.password,""),n.xp6(2),n.hij("\u5916\u7f6e\uff1a",s.chooseData.external,""),n.xp6(2),n.hij("\u7248\u672c\uff1a",s.chooseData.version,""),n.xp6(2),n.hij("\u547d\u4ee4\uff1a",s.chooseData.command,""),n.xp6(2),n.hij("\u72b6\u6001\uff1a",s.chooseData.running,""),n.xp6(2),n.hij("\u65e5\u671f\uff1a",n.lcZ(19,9,s.chooseData.created),"")}}function E(p,h){if(1&p&&(n.TgZ(0,"div")(1,"p"),n._uU(2),n.qZA(),n.TgZ(3,"p"),n._uU(4),n.qZA(),n.TgZ(5,"p"),n._uU(6),n.qZA(),n.TgZ(7,"p"),n._uU(8),n.ALo(9,"date"),n.qZA()()),2&p){const s=n.oxw(2);n.xp6(2),n.hij("\u4ea7\u54c1id\uff1a",s.chooseData.id,""),n.xp6(2),n.hij("\u540d\u79f0\uff1a",s.chooseData.name,""),n.xp6(2),n.hij("\u8bf4\u660e\uff1a",s.chooseData.desc,""),n.xp6(2),n.hij("\u65e5\u671f\uff1a",n.lcZ(9,4,s.chooseData.created),"")}}function b(p,h){if(1&p&&(n.TgZ(0,"div")(1,"p"),n._uU(2),n.qZA(),n.TgZ(3,"p"),n._uU(4),n.qZA(),n.TgZ(5,"p"),n._uU(6),n.qZA(),n.TgZ(7,"p"),n._uU(8),n.qZA(),n.TgZ(9,"p"),n._uU(10),n.ALo(11,"date"),n.qZA()()),2&p){const s=n.oxw(2);n.xp6(2),n.hij("\u603b\u7ebfid\uff1a",s.chooseData.id,""),n.xp6(2),n.hij("\u540d\u79f0\uff1a",s.chooseData.name,""),n.xp6(2),n.hij("\u8bf4\u660e\uff1a",s.chooseData.desc,""),n.xp6(2),n.hij("\u7aef\u53e3\uff1a",s.chooseData.port,""),n.xp6(2),n.hij("\u65e5\u671f\uff1a",n.lcZ(11,5,s.chooseData.created),"")}}function U(p,h){if(1&p&&(n.YNc(0,v,20,11,"div",4),n.YNc(1,E,10,6,"div",4),n.YNc(2,b,12,7,"div",4)),2&p){const s=n.oxw();n.Q6J("ngIf","\u63d2\u4ef6"===s.title),n.xp6(1),n.Q6J("ngIf","\u4ea7\u54c1"===s.title),n.xp6(1),n.Q6J("ngIf","\u603b\u7ebf"===s.title)}}function S(p,h){if(1&p){const s=n.EpF();n.TgZ(0,"button",5),n.NdJ("click",function(){n.CHM(s);const m=n.oxw();return n.KtG(m.handleEdit(m.chooseData.id))}),n._uU(1," \u7f16\u8f91 "),n.qZA(),n.TgZ(2,"button",6),n.NdJ("nzOnConfirm",function(){n.CHM(s);const m=n.oxw();return n.KtG(m.handleDelete(m.chooseData.id))})("nzOnCancel",function(){n.CHM(s);const m=n.oxw();return n.KtG(m.cancel())}),n._uU(3," \u5220\u9664 "),n.qZA(),n.TgZ(4,"button",5),n.NdJ("click",function(){n.CHM(s);const m=n.oxw();return n.KtG(m.handleClose())}),n._uU(5,"\u5173\u95ed"),n.qZA()}}let O=(()=>{var p;class h{constructor(c){this.msg=c,this.edit=new n.vpe,this.delete=new n.vpe,this.close=new n.vpe}handleEdit(c){this.edit.emit(c)}handleDelete(c){this.delete.emit(c)}handleClose(){this.close.emit()}cancel(){this.msg.info("\u53d6\u6d88\u5220\u9664")}}return(p=h).\u0275fac=function(c){return new(c||p)(n.Y36(C.dD))},p.\u0275cmp=n.Xpm({type:p,selectors:[["app-detail"]],inputs:{chooseData:"chooseData",title:"title",isVisible:"isVisible"},outputs:{edit:"edit",delete:"delete",close:"close"},decls:7,vars:4,consts:[[3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[4,"ngIf"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","primary","nz-popconfirm","","nzPopconfirmTitle","\u786e\u5b9a\u5220\u9664?","nzPopconfirmPlacement","top",3,"nzOnConfirm","nzOnCancel"]],template:function(c,m){if(1&c&&(n.TgZ(0,"nz-modal",0),n.NdJ("nzVisibleChange",function(D){return m.isVisible=D})("nzOnCancel",function(){return m.handleClose()}),n.YNc(1,F,1,1,"ng-template",null,1,n.W1O),n.YNc(3,U,3,3,"ng-template",null,2,n.W1O),n.YNc(5,S,6,0,"ng-template",null,3,n.W1O),n.qZA()),2&c){const Z=n.MAs(2),D=n.MAs(4),P=n.MAs(6);n.Q6J("nzVisible",m.isVisible)("nzTitle",Z)("nzContent",D)("nzFooter",P)}},dependencies:[z.O5,g.du,t.JW,f.ix,_.w,A.dQ,T.u]}),h})()},7518:(M,x,i)=>{i.r(x),i.d(x,{PluginModule:()=>on});var n=i(6895),C=i(4575),z=i(5380),g=i(433),t=i(4650),f=i(1445),_=i(9651),A=i(3679),T=i(6704),F=i(5635),v=i(1243),E=i(8213);function b(o,r){1&o&&(t.ynx(0),t._uU(1,"\u8bf7\u8f93\u5165ID!"),t.BQk())}function U(o,r){1&o&&t.YNc(0,b,2,0,"ng-container",23),2&o&&t.Q6J("ngIf",r.$implicit.hasError("required"))}function S(o,r){1&o&&(t.ynx(0),t._uU(1,"\u8bf7\u8f93\u5165\u540d\u79f0!"),t.BQk())}function O(o,r){1&o&&t.YNc(0,S,2,0,"ng-container",23),2&o&&t.Q6J("ngIf",r.$implicit.hasError("required"))}function p(o,r){1&o&&(t.ynx(0),t._uU(1,"\u8bf7\u8f93\u5165\u7248\u672c!"),t.BQk())}function h(o,r){1&o&&t.YNc(0,p,2,0,"ng-container",23),2&o&&t.Q6J("ngIf",r.$implicit.hasError("required"))}function s(o,r){1&o&&(t.ynx(0),t._uU(1,"\u8bf7\u8f93\u5165\u547d\u4ee4!"),t.BQk())}function c(o,r){1&o&&t.YNc(0,s,2,0,"ng-container",23),2&o&&t.Q6J("ngIf",r.$implicit.hasError("required"))}let m=(()=>{var o;class r{constructor(e,a,l){this.fb=e,this.rs=a,this.msg=l,this.id=""}ngOnInit(){this.id&&this.rs.get(`plugin/${this.id}`).subscribe(e=>{this.build(e.data)}),this.build()}build(e){this.group=this.fb.group({id:[(e=e||{}).id||"",[]],name:[e.name||"",[g.kI.required]],version:[e.version||"",[]],username:[e.username||"",[]],password:[e.password||"",[]],external:[e.external||!1,[]],command:[e.command||"",[]],dependencies:[e.dependencies||{},[]],disabled:[e.disabled||!1,[]]})}submit(){return new Promise((e,a)=>{this.group.valid?this.rs.post(this.id?`plugin/${this.id}`:"plugin/create",this.group.value).subscribe(d=>{this.msg.success("\u4fdd\u5b58\u6210\u529f"),e(!0)}):Object.values(this.group.controls).forEach(l=>{l.invalid&&(l.markAsDirty(),l.updateValueAndValidity({onlySelf:!0}),a())})})}}return(o=r).\u0275fac=function(e){return new(e||o)(t.Y36(g.qu),t.Y36(f.s),t.Y36(_.dD))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-plugin-edit"]],inputs:{id:"id"},decls:50,vars:37,consts:[["nz-form","",3,"formGroup","ngSubmit"],["nzFor","id",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzErrorTip"],["nz-input","","formControlName","id"],["IDErrorTpl",""],["nzFor","name","nzRequired","",3,"nzSm","nzXs"],["nz-input","","formControlName","name"],["nameErrorTpl",""],["nzFor","username",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["nz-input","","formControlName","username"],["nzFor","password",3,"nzSm","nzXs"],["nz-input","","type","password","formControlName","password"],["nzFor","external",3,"nzSm","nzXs"],["nz-checkbox","","formControlName","external"],["nzFor","version",3,"nzSm","nzXs"],["nz-input","","formControlName","version"],["verErrorTpl",""],["nzFor","command",3,"nzSm","nzXs"],["nz-input","","formControlName","command"],["comErrorTpl",""],["nzFor","disabled",3,"nzSm","nzXs"],["nzCheckedChildren","\u662f","nzUnCheckedChildren","\u5426","name","disabled","formControlName","disabled"],[4,"ngIf"]],template:function(e,a){if(1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return a.submit()}),t.TgZ(1,"nz-form-item")(2,"nz-form-label",1),t._uU(3,"ID"),t.qZA(),t.TgZ(4,"nz-form-control",2),t._UZ(5,"input",3),t.YNc(6,U,1,1,"ng-template",null,4,t.W1O),t.qZA()(),t.TgZ(8,"nz-form-item")(9,"nz-form-label",5),t._uU(10,"\u540d\u79f0"),t.qZA(),t.TgZ(11,"nz-form-control",2),t._UZ(12,"input",6),t.YNc(13,O,1,1,"ng-template",null,7,t.W1O),t.qZA()(),t.TgZ(15,"nz-form-item")(16,"nz-form-label",8),t._uU(17,"\u7528\u6237\u540d"),t.qZA(),t.TgZ(18,"nz-form-control",9),t._UZ(19,"input",10),t.qZA()(),t.TgZ(20,"nz-form-item")(21,"nz-form-label",11),t._uU(22,"\u5bc6\u7801"),t.qZA(),t.TgZ(23,"nz-form-control",9),t._UZ(24,"input",12),t.qZA()(),t.TgZ(25,"nz-form-item")(26,"nz-form-label",13),t._uU(27,"\u5916\u90e8"),t.qZA(),t.TgZ(28,"nz-form-control",9)(29,"label",14),t._uU(30,"\u5916\u90e8"),t.qZA()()(),t.TgZ(31,"nz-form-item")(32,"nz-form-label",15),t._uU(33,"\u7248\u672c"),t.qZA(),t.TgZ(34,"nz-form-control",2),t._UZ(35,"input",16),t.YNc(36,h,1,1,"ng-template",null,17,t.W1O),t.qZA()(),t.TgZ(38,"nz-form-item")(39,"nz-form-label",18),t._uU(40,"\u547d\u4ee4"),t.qZA(),t.TgZ(41,"nz-form-control",2),t._UZ(42,"input",19),t.YNc(43,c,1,1,"ng-template",null,20,t.W1O),t.qZA()(),t.TgZ(45,"nz-form-item")(46,"nz-form-label",21),t._uU(47,"\u662f\u5426\u7981\u7528"),t.qZA(),t.TgZ(48,"nz-form-control",9),t._UZ(49,"nz-switch",22),t.qZA()()()),2&e){const l=t.MAs(7),d=t.MAs(14),an=t.MAs(37),sn=t.MAs(44);t.Q6J("formGroup",a.group),t.xp6(2),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24)("nzErrorTip",l),t.xp6(5),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24)("nzErrorTip",d),t.xp6(5),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24),t.xp6(3),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24),t.xp6(3),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24),t.xp6(4),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24)("nzErrorTip",an),t.xp6(5),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24)("nzErrorTip",sn),t.xp6(5),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24)}},dependencies:[n.O5,A.t3,A.SK,T.Lr,T.Nx,T.iK,T.Fd,g._Y,g.Fj,g.JJ,g.JL,g.sg,g.u,F.Zp,v.i,E.Ie]}),r})();var Z=i(235),D=i(6960),P=i(1634),J=i(5227),y=i(8989),Q=i(7327),B=i(1918),I=i(558);function N(o,r){if(1&o){const u=t.EpF();t.TgZ(0,"div",6),t.NdJ("click",function(){const l=t.CHM(u).$implicit,d=t.oxw();return t.KtG(d.informate(l))}),t._UZ(1,"app-card",7),t.qZA()}if(2&o){const u=r.$implicit;t.xp6(1),t.Q6J("img","plugin.png")("id",u.id)("name",u.name)("title","\u63d2\u4ef6")}}let X=(()=>{var o;class r{constructor(e,a,l,d){this.modal=e,this.router=a,this.rs=l,this.msg=d,this.isVisible=!1,this.loading=!0,this.chooseData={},this.datum=[],this.total=1,this.pageSize=20,this.pageIndex=1,this.query={},this.checked=!1,this.indeterminate=!1,this.setOfCheckedId=new Set,this.delResData=[],this.pageSizeChange(this.pageSize)}reload(){this.datum=[],this.load()}close(){this.isVisible=!1}informate(e){this.isVisible=!0,this.rs.get(`plugin/${e.id}`,this.query).subscribe(a=>{this.chooseData=a.data}).add(()=>{this.loading=!1})}load(){this.loading=!0,this.rs.post("plugin/search",this.query).subscribe(e=>{this.datum=e.data||[],this.total=e.total}).add(()=>{this.loading=!1})}enable(e){this.rs.get(`plugin/${e}/enable`).subscribe(a=>{this.reload()})}disable(e){this.rs.get(`plugin/${e}/disable`).subscribe(a=>{this.reload()})}plugin(e,a){switch(e){case 0:this.rs.get(`plugin/${a}/start`).subscribe(l=>{this.load()});break;case 1:this.rs.get(`plugin/${a}/stop`).subscribe(l=>{this.load()});break;case 2:this.rs.get(`plugin/${a}/restart`).subscribe(l=>{this.load()})}}create(){let e="/plugin/create";location.pathname.startsWith("/admin")&&(e="/admin"+e),this.router.navigateByUrl(e)}handleExport(){this.href="/api/plugin/export"}delete(e,a){this.rs.get(`plugin/${e}/delete`).subscribe(l=>{a?a&&(this.delResData.push(l),a===this.delResData.length&&(this.msg.success("\u5220\u9664\u6210\u529f"),this.load())):(this.msg.success("\u5220\u9664\u6210\u529f"),this.datum=this.datum.filter(d=>d.id!==e))})}onQuery(e){(0,z.r)(e,this.query),this.load()}pageIndexChange(e){this.query.skip=e-1,this.load()}pageSizeChange(e){this.query.limit=e,this.load()}search(e){this.query.keyword={name:e},this.query.skip=0,this.load()}cancel(){this.msg.info("\u53d6\u6d88\u64cd\u4f5c")}handleEdit(e){this.isVisible=!1;const l=this.modal.create({nzTitle:e?"\u7f16\u8f91\u63d2\u4ef6":"\u521b\u5efa\u63d2\u4ef6",nzStyle:{top:"20px"},nzContent:m,nzComponentParams:{id:e},nzMaskClosable:!1,nzFooter:[{label:"\u53d6\u6d88",onClick:()=>{l.destroy()}},{label:"\u4fdd\u5b58",type:"primary",onClick:d=>{d.submit().then(()=>{l.destroy(),this.load()},()=>{})}}]})}handleBatchDel(){(0,Z.mK)(this)}handleAllChecked(e){(0,Z.Yk)(e,this)}handleItemChecked(e,a){(0,Z.mp)(e,a,this)}}return(o=r).\u0275fac=function(e){return new(e||o)(t.Y36(D.Sf),t.Y36(C.F0),t.Y36(f.s),t.Y36(_.dD))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-plugins"]],decls:7,vars:9,consts:[["placeholder","\u8bf7\u8f93\u5165\u540d\u79f0",3,"onSearch"],["uploadApi","/api/plugin/import","downloadApi","/api/plugin/export",3,"showDelBtn","add"],["nz-row","",1,"card",3,"nzGutter"],["nz-col","","class","card-item",3,"click",4,"ngFor","ngForOf"],[3,"isVisible","title","chooseData","edit","delete","close"],["nzShowSizeChanger","",2,"position","fixed","bottom","0","right","10px",3,"nzPageIndex","nzTotal","nzPageSize","nzPageSizeChange","nzPageIndexChange"],["nz-col","",1,"card-item",3,"click"],[3,"img","id","name","title"]],template:function(e,a){1&e&&(t.TgZ(0,"app-toolbar")(1,"app-search-form",0),t.NdJ("onSearch",function(d){return a.search(d)}),t.qZA(),t.TgZ(2,"app-batch-btn",1),t.NdJ("add",function(){return a.handleEdit()}),t.qZA()(),t.TgZ(3,"div",2),t.YNc(4,N,2,4,"div",3),t.qZA(),t.TgZ(5,"app-detail",4),t.NdJ("edit",function(d){return a.handleEdit(d)})("delete",function(d){return a.delete(d)})("close",function(){return a.close()}),t.qZA(),t.TgZ(6,"nz-pagination",5),t.NdJ("nzPageSizeChange",function(d){return a.pageSizeChange(d)})("nzPageIndexChange",function(d){return a.pageIndexChange(d)}),t.qZA()),2&e&&(t.xp6(2),t.Q6J("showDelBtn",!1),t.xp6(1),t.Q6J("nzGutter",16),t.xp6(1),t.Q6J("ngForOf",a.datum),t.xp6(1),t.Q6J("isVisible",a.isVisible)("title","\u63d2\u4ef6")("chooseData",a.chooseData),t.xp6(1),t.Q6J("nzPageIndex",a.pageIndex)("nzTotal",a.total)("nzPageSize",a.pageSize))},dependencies:[n.sg,P.dE,A.t3,A.SK,J.n,y.A,Q.J,B.o,I.q],styles:[".card[_ngcontent-%COMP%]{box-sizing:border-box;padding:10px 20px;width:100%}.card[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px}.card[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),r})();var Y=i(1346);const q=[{path:"",pathMatch:"full",redirectTo:"list"},{path:"list",component:X},{path:"detail/:id",component:(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-plugin-detail"]],decls:2,vars:0,template:function(e,a){1&e&&(t.TgZ(0,"p"),t._uU(1,"plugin-detail works!"),t.qZA())}}),r})()},{path:"edit/:id",component:m},{path:"create",component:m},{path:"**",component:Y.r}];let K=(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[C.Bz.forChild(q),C.Bz]}),r})();var W=i(8284),V=i(3325),L=i(7423),R=i(1971),$=i(7096),j=i(6616),G=i(9166),H=i(6903),w=i(269),k=i(2577),nn=i(6497),tn=i(6672),en=i(8521);let on=(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[n.ez,K,W.wm,V.ip,L.PV,R.vh,P.uK,D.Qp,T.U5,nn._p,tn.X,g.UX,F.o7,$.Zf,j.sL,G.Y,H.zf,w.HQ,k.S,v.m,en.aF,E.Wr]}),r})()}}]);